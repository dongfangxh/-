USE 学生管理
/*1.分组统计查询学生表中男女生的平均入学成绩。*/
SELECT 性别,AVG(入学成绩) AS 平均成绩
FROM 学生表
GROUP BY 性别

/*2.查询入学成绩最高的三位学生信息。*/
SELECT TOP 3 *
FROM 学生表
ORDER BY 入学成绩 DESC


/*3.分组查询显示人数大于等于2的不同年份出生的学生人数*/
SELECT YEAR(出生日期) 出生年份,COUNT(*) 人数
FROM 学生表
GROUP BY YEAR(出生日期)
HAVING COUNT(*)>=2


/*4.使用内连接查询学生的学号、姓名、课程号与成绩。*/
SELECT 学生表.学号,姓名,课程号,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号

/*5.查询男同学的学号、姓名、课程号与成绩。*/
SELECT 学生表.学号,姓名,课程号,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
WHERE 性别='男'

/*6.查询选修了330110号课程的学生姓名，课程号与成绩。*/
SELECT 姓名,课程号,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
WHERE 课程号='330110'

/*7.查询选修了大数据应用课程的学生学号、课程名与成绩。*/
SELECT 学号,课程名,成绩
FROM 成绩表 INNER JOIN 课程表
ON 成绩表.课程号 = 课程表.课程号
WHERE 课程名='大数据应用'


/*8.查询成绩大于80分的学生的姓名、课程号与成绩。*/
SELECT 姓名,课程号,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
WHERE 成绩>80


/*9.查询选修了课程的学生姓名、课程名与成绩。*/
SELECT 姓名,课程名,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
INNER JOIN 课程表
ON 成绩表.课程号 = 课程表.课程号


/*10.查询姓名中含李字的学生姓名与成绩。*/
SELECT 姓名,成绩
FROM 学生表 INNER JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
WHERE 姓名 LIKE '%李%'



/*11.查询显示每个学生的平均成绩。*/
SELECT 姓名,AVG(成绩) AS 平均成绩
FROM 学生表 LEFT JOIN 成绩表
ON 学生表.学号 = 成绩表.学号
GROUP BY 姓名